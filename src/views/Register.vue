<template>
  <Navbar />
  <div class="wrapper">
    <div class="card">
      <input type="checkbox" id="card1" class="more" aria-hidden="true">
      <div class="content">
        <div class="front">
          <div class="inner">
            <h2>Please note that payment validates registration. Click below for payment details.</h2>
            <label for="card1" class="button" aria-hidden="true">
              Details
            </label>
          </div>
        </div>
        <div class="back">
          <div class="inner">
            <div class="info">
              <svg width="99" height="22" viewBox="0 0 99 22" fill="none"><path d="M58.4144 6.81538V21.764H54.0773V19.5807C53.6053 20.3675 52.9857 20.9674 52.2186 21.3804C51.4515 21.7935 50.586 22 49.6222 22C47.7537 22 46.3572 21.4788 45.4327 20.4363C44.5083 19.3938 44.046 17.8203 44.046 15.7157V6.81538H48.5011V15.8042C48.5011 17.6138 49.278 18.5186 50.8319 18.5186C51.7563 18.5186 52.5038 18.2038 53.0742 17.5744C53.6446 16.945 53.9298 16.1189 53.9298 15.0961V6.81538H58.4144ZM75.4086 0V21.764H71.0125V19.5512C70.5601 20.3183 69.9209 20.9182 69.0947 21.3509C68.2686 21.7836 67.3344 22 66.2919 22C65.0134 22 63.8726 21.6755 62.8695 21.0165C61.8663 20.3576 61.0894 19.4332 60.5288 18.2432C59.9682 17.0532 59.6929 15.696 59.6929 14.1618C59.6929 12.6276 59.9682 11.2803 60.5288 10.11C61.0894 8.93965 61.8663 8.03487 62.8596 7.39562C63.8529 6.75637 64.9937 6.44166 66.2919 6.44166C67.295 6.44166 68.2096 6.65802 69.0357 7.07108C69.8619 7.49396 70.5011 8.07421 70.9535 8.82164V0H75.4086ZM70.1274 17.4761C70.7175 16.7188 71.0125 15.637 71.0125 14.2208C71.0125 12.8243 70.7175 11.7523 70.1175 10.9951C69.5176 10.2378 68.6817 9.8641 67.5999 9.8641C66.4984 9.8641 65.6428 10.2378 65.0331 10.9852C64.4233 11.7327 64.1184 12.7948 64.1184 14.1717C64.1184 15.5878 64.4233 16.6795 65.0331 17.4564C65.6428 18.2333 66.4984 18.6169 67.5999 18.6169C68.7014 18.6071 69.5373 18.2333 70.1274 17.4761ZM92.4126 6.81538V21.764H88.0165V19.5512C87.5641 20.3183 86.9249 20.9182 86.0988 21.3509C85.2727 21.7836 84.3384 22 83.2959 22C81.9977 22 80.8569 21.6853 79.8636 21.0559C78.8703 20.4265 78.0934 19.5315 77.5328 18.3612C76.9723 17.1909 76.6969 15.8435 76.6969 14.3093C76.6969 12.7751 76.9723 11.4081 77.5328 10.2083C78.0934 9.00849 78.8703 8.08404 79.8735 7.42512C80.8766 6.7662 82.0174 6.44166 83.2959 6.44166C84.3384 6.44166 85.2727 6.66786 86.0988 7.12025C86.9249 7.57264 87.5641 8.18239 88.0165 8.94949V6.81538H92.4126ZM87.1314 17.4859C87.7215 16.7385 88.0165 15.6567 88.0165 14.2405C88.0165 12.8243 87.7215 11.7425 87.1314 10.9852C86.5413 10.228 85.6956 9.85427 84.5941 9.85427C83.4926 9.85427 82.637 10.2477 82.0272 11.0344C81.4175 11.8212 81.1126 12.9128 81.1126 14.3093C81.1126 15.7059 81.4077 16.768 82.0076 17.5056C82.6075 18.2432 83.4631 18.6071 84.5842 18.6071C85.6956 18.6071 86.5413 18.2333 87.1314 17.4859ZM43.1511 21.9803H37.624L31.6839 15.2043V21.9803H27.1797V0H31.6839V13.3456L37.3585 6.86455H42.7675L36.3455 14.1225L43.1511 21.9803Z" fill="#40196D"></path><path d="M14.8207 21.9803L6.17613 12.0277L10.8967 21.9803H7.62181L2.80286 11.831L4.80912 21.9803H2.79303L0.786768 11.8114V21.9803H0V0H0.786768V10.9656L2.82253 0H4.82879L2.78319 11.0148L7.70049 0H10.9361L6.04828 10.9754L14.9289 0H20.0134L10.8181 11.3491L20.0527 21.9803H14.8207Z" fill="#40196D"></path><path d="M96.146 21.7447C97.493 21.7447 98.585 20.6527 98.585 19.3057C98.585 17.9587 97.493 16.8667 96.146 16.8667C94.799 16.8667 93.707 17.9587 93.707 19.3057C93.707 20.6527 94.799 21.7447 96.146 21.7447Z" fill="#40196D"></path></svg>
            </div>
            <div class="description">
              <p>Bank: <span>Kuda Bank</span></p>
              <p>Account Number: <span>2008500959</span></p>
              <p>Account Name: <span>Animashaun M. Olamiji</span></p>
            </div>
            <label for="card1" class="button return" aria-hidden="true">
              Okay
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="login-root" v-if="!registered">
    <div class="formbg-outer">
      <div class="formbg">
        <div class="formbg-inner">
          <span class="padding-bottom--15">Register to participate</span>
          <form id="stripe-login" @submit.prevent="addPlayer">
            <div class="field padding-bottom--24">
              <label for="email">Email</label>
              <input type="email" name="email" v-model="email" required>
            </div>
            <div class="field padding-bottom--24">
              <label for="username">Name</label>
              <input type="text" name="username" v-model="name" required>
            </div>
            <div class="field padding-bottom--24">
              <label for="faculty">Faculty</label>
              <input type="text" name="faculty" v-model="faculty" required>
            </div>
            <div class="field padding-bottom--24">
              <label for="department">Department</label>
              <input type="text" name="department" v-model="department" required>
            </div>
            <div class="field padding-bottom--24">
              <label for="phone">Whatsapp Mobile Number</label>
              <input type="telephone" name="phone" v-model="phone" required>
            </div>
            <div class="field padding-bottom--24">
              <label for="game">Game to play</label>
              <select @change="pes" v-model="game" required>
                <option value="cod"><p>COD Mobile(<span>&#8358</span>500)</p></option>
                <option value="pes">PES Mobile(<span>&#8358</span>500)</option>
                <option value="both">Both(<span>&#8358</span>1,000)</option>
              </select>
            </div>
            <div class="field padding-bottom--24" v-if="isCod">
              <label class="padding-bottom--7" for="codid">COD Username</label>
              <input type="text" name="codid" v-model="codid" required>
            </div>
            <div class="field padding-bottom--24" v-if="isPes">
              <label class="padding-bottom--7" for="teamname">Team Name</label>
              <input type="text" name="teamname" v-model="teamname" required>
            </div>
            <div class="field padding-bottom--24" v-if="isPes">
              <label class="padding-bottom--7" for="userid">User Id</label>
              <input type="text" name="userid" v-model="userid" required>
            </div>
            <div class="field padding-bottom--24"><button class="submi" v-if="loading">
                <svg width="38" height="38" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#fff">
                  <g fill="none" fill-rule="evenodd">
                    <g transform="translate(1 1)" stroke-width="2">
                      <circle stroke-opacity=".5" cx="18" cy="18" r="18"/>
                      <path d="M36 18c0-9.94-8.06-18-18-18">
                        <animateTransform
                            attributeName="transform"
                            type="rotate"
                            from="0 18 18"
                            to="360 18 18"
                            dur="1s"
                            repeatCount="indefinite"/>
                      </path>
                    </g>
                </g>
              </svg>
              </button>
              <button class="submit" v-else>Register</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
  <div class="rfront" v-if="registered">
    <div class="rinner">
      <h2>Registration Successful!</h2>
      <h2>Please click the below button for payment confirmation.</h2>
      <button for="card1" class="button">
        <a href="https://wa.me/2348171464003?text=Hi,%20I%20want%20to%20confirm%20my%20tournament%20payment">Click here</a>
      </button>
    </div>
  </div>
  <div class="enquiries">
    <h4>For more enquiries and sponsorships:</h4>
    <div class="contact">
      MJ - <span> <a href="https://wa.me/2348171464003">08171464003</a></span>, Saybudu - <span><a href="https://wa.me/2348103840212">08103840212</a>,</span> Williams - <span><a href="https://wa.me/2349034696604">09034696604</a></span>
    </div>
  </div>
</template>

<script>
import Navbar from '../components/Navbar'
import { ref } from 'vue'
import { supabase } from '../supabase'

export default {
  components: {
    Navbar
  },
  setup() {
    const name = ref('')
    const email = ref('')
    const faculty = ref('')
    const department = ref('')
    const phone = ref('')
    const game = ref('')
    const codid = ref('')
    const teamname = ref('')
    const userid = ref('')
    const loading = ref(false)
    const registered = ref(false)
    const isPes = ref(false)
    const isCod = ref(false)
    const both = ref(false)

    const pes = () => {
      if(game.value == "cod") {
        isCod.value = true
        isPes.value = false
      } else if(game.value == "pes") {
        isPes.value = true
        isCod.value = false
      } else if(game.value == "both"){
        isCod.value = true
        isPes.value = true
      }
    }

    const addPlayer = async () => {
      try {
        loading.value = true
        const { data, error } = await supabase
        .from('players')
        .insert([
          {
            name: name.value,
            email: email.value,
            faculty: faculty.value,
            department: department.value,
            phone: phone.value,
            game: game.value,
            team_name: teamname.value,
            cod_username: codid.value,
            userid: userid.value
          }
        ])
        name.value = '',
        email.value = '',
        faculty.value = '',
        department.value = '',
        phone.value = '',
        game.value = '',
        teamname.value = '',
        codid.value = ''
        userid.value = '',
        loading.value = false
        registered.value = true
      } catch (error) {
      }
    }

    return {
      name,
      email,
      faculty,
      department,
      phone,
      game,
      codid,
      teamname,
      userid,
      loading,
      registered,
      isCod,
      isPes,
      both,
      pes,
      addPlayer
    }
  }
}
</script>

<style>
.wrapper {
  display: flex;
  flex-flow: row wrap;
  justify-content: center;
}

.card {
  width: 420px;
  height: 340px;
  margin: 1em;
  perspective: 1500px;
}

.card .content {
  position: relative;
  width: 100%;
  height: 100%;
  transform-style: preserve-3d;
  transition: transform 0.8s cubic-bezier(0.75, 0, 0.85, 1);
}

.more {
  display: none;
}

.more:checked ~ .content {
  transform: rotateY(180deg);
}

.front, .back {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  transform-style: preserve-3d;
  border-radius: 6px;
}

.front .inner, .back .inner {
  height: 100%;
  display: grid;
  padding: 1.5em;
  transform: translateZ(80px) scale(0.94);
}

.front:after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  border-radius: 20px;
  background: #40196d;
}

.front .inner {
  grid-template-rows: 5fr 1fr 1fr 2fr 1fr;
  justify-items: center;
}

.front h2 {
  grid-row: 2;
  margin-bottom: 0.3em;
  text-transform: uppercase;
  letter-spacing: 3px;
  color: #fff;
  font-weight: 500;
  text-shadow: 0 0 6px rgba(0, 0, 0, 0.1);
}

.back {
  transform: rotateY(180deg);
  background-color: #fff;
  border: 2px solid #f0f0f0;
}

.back .inner {
  grid-template-rows: 1fr 2fr 1fr 2fr 14fr 1fr 1fr;
  grid-template-columns: repeat(4, auto);
  grid-column-gap: 0.8em;
  justify-items: center;
}

.back .info {
  position: relative;
  display: flex;
  align-items: center;
  color: #355cc9;
  grid-row: 3;
}

.back .info:not(:first-of-type):before {
  content: '';
  position: absolute;
  left: -0.9em;
  height: 18px;
  width: 1px;
  background-color: #ccc;
}

.back .info span {
  font-size: 2em;
  font-weight: 700;
}

.back .description {
  grid-row: 5;
  grid-column: 1/-1;
  font-size: 0.86em;
  border-radius: 5px;
  font-weight: 600;
  line-height: 1.4em;
  overflow: visible;
  color: #355cc9;
  padding-right: 10px;
  margin-top: 10px;
}

.back .button {
  grid-column: 1/-1;
  justify-self: center;
}

.button {
  grid-row: -1;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-weight: 600;
  cursor: pointer;
  padding: 0 1.5em;
  line-height: 2.9em;
  background-color: #ece5e5e3;
  color: #40196d;
  border-radius: 4px;
}

.button:hover {
  background-color: #fff;
  box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
  text-shadow: none;
  color: #355cc9;
}

.button .return {
  line-height: 3em;
  color: #355cc9;
  border-color: #355cc9;
  text-shadow: none;
}

.button .return:hover {
  background-color: #355cc9;
  color: #fff;
  box-shadow: none;
}

.submi {
  padding: 5px 16px;
  width: 100%;
  min-height: 44px;
  border: unset;
  border-radius: 4px;
  background-color: #353030;
  box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(0, 0, 0, 0.12) 0px 1px 1px 0px, 
              #353030 0px 0px 0px 1px, 
              rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(60, 66, 87, 0.08) 0px 2px 5px 0px;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}
.submi svg {
  width: 25px;
}

.flex-flex {
    display: flex;
}
.align-center {
  align-items: center; 
}
.center-center {
  align-items: center;
  justify-content: center;
}
.box-root {
    box-sizing: border-box;
}
.flex-direction--column {
    -ms-flex-direction: column;
    flex-direction: column;
}

.padding-top--64 {
  padding-top: 64px;
}
.padding-top--48 {
  padding-top: 48px;
}
.padding-bottom--24 {
  padding-bottom: 24px;
}

.formbg-inner {
  padding: 48px;
  padding-bottom: 0px;
}

.padding-bottom--15 {
  padding-bottom: 15px;
}

.padding-bottom--7 {
  margin-bottom: 7px;
}
.flex-justifyContent--center {
  -ms-flex-pack: center;
  justify-content: center;
}

span {
    display: block;
    font-size: 20px;
    line-height: 28px;
    color: #1a1f36;
}
label {
    margin-bottom: 10px;
}
.grid--50-50 {
    display: grid;
    grid-template-columns: 50% 50%;
    align-items: center;
}
.field input,
.field select {
    font-size: 16px;
    line-height: 28px;
    margin-top: 10px;
    padding: 8px 16px;
    width: 100%;
    min-height: 44px;
    border: unset;
    border-radius: 4px;
    outline-color: rgb(84 105 212 / 0.5);
    background-color: rgb(255, 255, 255);
    box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
                rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
                rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
                rgba(60, 66, 87, 0.16) 0px 0px 0px 1px, 
                rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
                rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
                rgba(0, 0, 0, 0) 0px 0px 0px 0px;
}
.submit {
  font-size: 16px;
  line-height: 28px;
  padding: 8px 16px;
  width: 100%;
  min-height: 44px;
  border: unset;
  border-radius: 4px;
  background-color: #353030;
  box-shadow: rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(0, 0, 0, 0.12) 0px 1px 1px 0px, 
              #353030 0px 0px 0px 1px, 
              rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(0, 0, 0, 0) 0px 0px 0px 0px, 
              rgba(60, 66, 87, 0.08) 0px 2px 5px 0px;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
}
.field-checkbox input {
    width: 20px;
    height: 15px;
    margin-right: 5px; 
    box-shadow: unset;
    min-height: unset;
}
.field-checkbox label {
    display: flex;
    align-items: center;
}

.rfront {
  margin: 2rem;
  background-color: #40196d;
  padding: 1.3rem;
  border-radius: 20px;
  color: #fff;
}

.rfront h2 {
  text-transform: uppercase;
  letter-spacing: 3px;
  color: #fff;
  font-weight: 500;
  padding-block: .5rem;
}

.rfront .rinner{
  padding: 1.5em;
}

.rfront .rinner .button {
  border: none;
  cursor: pointer;
  margin-top: 10px;
  padding: .4rem;
  font-weight: 600;
  border-radius: 4px;
}

.rfront .rinner .button:hover {
  background-color: #fff;
  box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
  text-shadow: none;
  color: #355cc9;
}

.rfront .rinner .button a {
  color: #40196d;
  text-decoration: none;  
}

</style>